<button
  *ngIf="files.length > 0"
  class="attachments-btn"
  (click)="togglePopup()">
  ðŸ“Ž Allegati ({{ files.length }})
</button>

<div class="attachments-popup" *ngIf="showPopup" (click)="closePopup()">
  <div class="popup-content" (click)="$event.stopPropagation()">
    <div class="popup-header">
      <h3>ðŸ“Ž Allegati</h3>
      <button class="close-btn" (click)="closePopup()">âœ–</button>
    </div>

    <div class="attachments-grid">
      <div *ngFor="let file of files; let i = index" class="attachment-item">
        
        <!-- âœ… IMMAGINE -->
        <img
          *ngIf="isImage(file.name)"
          [src]="previews.get(file.name)"
          [alt]="file.name"
          class="preview-image"
          (click)="openFullPreview(previews.get(file.name)!, file.name)" />

        <!-- ðŸ“„ FILE NORMALE -->
        <div *ngIf="!isImage(file.name)" class="file-icon">ðŸ“„</div>

        <span class="file-name">{{ file.name }}</span>
        <button class="remove-btn" (click)="remove.emit(i)">âœ–</button>
      </div>
    </div>
  </div>
</div>
